Задание 1.
Отобрать различные (уникальные) элементы столбца amount таблицы book.

+---------+-----------------------+------------------+--------+--------+
| book_id | title                 | author           | price  | amount |
+---------+-----------------------+------------------+--------+--------+
| 1       | Мастер и Маргарита    | Булгаков М.А.    | 670.99 | 3      |
| 2       | Белая гвардия         | Булгаков М.А.    | 540.50 | 5      |
| 3       | Идиот                 | Достоевский Ф.М. | 460.00 | 10     |
| 4       | Братья Карамазовы     | Достоевский Ф.М. | 799.01 | 3      |
| 5       | Игрок                 | Достоевский Ф.М. | 480.50 | 10     |
| 6       | Стихотворения и поэмы | Есенин С.А.      | 650.00 | 15     |
+---------+-----------------------+------------------+--------+--------+

Решение Задание 1.

SELECT DISTINCT amount FROM book;

Задание 2.
Посчитать, количество различных книг и количество экземпляров книг каждого автора , хранящихся на складе.  
Столбцы назвать Автор, Различных_книг и Количество_экземпляров соответственно.

Решение Задание 2.

SELECT author AS "Автор", COUNT(amount) AS "Различных_книг", SUM(amount) AS "Количество_экземпляров" FROM book
GROUP BY author;

Задание 3.
Вывести фамилию и инициалы автора, минимальную, максимальную и среднюю цену книг каждого автора . 
Вычисляемые столбцы назвать Минимальная_цена, Максимальная_цена и Средняя_цена соответственно.

Решение Задания 3.

SELECT author, MIN(price) AS "Минимальная_цена", MAX(price) AS "Максимальная_цена", AVG(price) AS 
"Средняя_цена" FROM book
GROUP BY author;

Задание 4.
Для каждого автора вычислить суммарную стоимость книг S (имя столбца Стоимость), 
а также вычислить налог на добавленную стоимость  для полученных сумм (имя столбца НДС ) , который включен в стоимость и составляет k = 18%,  
а также стоимость книг  (Стоимость_без_НДС) без него. Значения округлить до двух знаков после запятой. 

Решение Задания 4.

SELECT author, ROUND(SUM(price * amount), 2) AS
"Стоимость", ROUND(SUM((price * amount * 18 /100) / (1 + 18 / 100)), 2) AS "НДС", 
ROUND(SUM((price * amount) / (1 + 18 / 100)), 2) AS "Стоимость_без_НДС"
FROM book
GROUP BY author;

Задание 5.
Вывести  цену самой дешевой книги, цену самой дорогой и среднюю цену уникальных книг на складе. Названия столбцов Минимальная_цена, Максимальная_цена, 
Средняя_цена соответственно. 
Среднюю цену округлить до двух знаков после запятой.

Решение Задания 5.

SELECT DISTINCT MIN(price) AS "Минимальная_цена",
MAX(price) AS "Максимальная_цена", ROUND(AVG(price), 2) AS "Средняя_цена"
FROM book;

Задание 6.
Вычислить среднюю цену и суммарную стоимость тех книг, количество экземпляров которых принадлежит интервалу от 5 до 14, включительно. 
Столбцы назвать Средняя_цена и Стоимость, значения округлить до 2-х знаков после запятой.

Решение Задания 6.

SELECT DISTINCT ROUND(AVG(price), 2) AS "Средняя_цена", ROUND(SUM(price*amount), 2) AS "Стоимость"
FROM book
WHERE amount BETWEEN 5 AND 14;

Задание 7.
Посчитать стоимость всех экземпляров каждого автора без учета книг «Идиот» и «Белая гвардия». 
В результат включить только тех авторов, у которых суммарная стоимость книг (без учета книг «Идиот» и «Белая гвардия») более 5000 руб. 
Вычисляемый столбец назвать Стоимость. Результат отсортировать по убыванию стоимости.

Решение Задания 7.

SELECT author, SUM(price*amount) AS "Стоимость"
FROM book
WHERE title <> "Идиот" AND title <> "Белая Гвардия"
GROUP BY author
HAVING SUM(price*amount) > 5000
ORDER BY author DESC;

Задание 8.
Придумайте один или несколько запросов к нашей таблице book, используя групповые функции. Проверьте, правильно ли они работают.
Узнать сколько авторов, у которых есть книги со стоимостью более 500 и количеством более 1 шт на складе,
при количестве различных названий произведений не менее 2-х. 
Вывести автора, количество различных произведений автора, минимальную цену и количество книг на складе.

Решение Задание 8.

SELECT author, COUNT(title) AS "Количество_произведений", MIN(price) AS "Минимальная_цена", SUM(amount) AS "Число_книг"  
FROM book
WHERE price>500 AND amount > 1
GROUP BY author
HAVING COUNT(title) >= 2;



